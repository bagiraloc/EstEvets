<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ó–æ–ª–æ—Ç–∞ –û—Å—ñ–Ω—å 2025 üçÅ</title>

  <!-- Firebase SDK -->
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getDatabase, ref, set, get, child, update, onValue } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-database.js";

    /* üëáüëá –°–Æ–î–ò –í–°–¢–ê–í –°–í–Ü–ô firebaseConfig üëáüëá */
    const firebaseConfig = {
      // —Ç–≤—ñ–π –±–ª–æ–∫ firebaseConfig –∑–≤—ñ–¥—Å–∏
    };
    /* üëÜüëÜ –í–°–¢–ê–í –°–Æ–î–ò üëÜüëÜ */

    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    /* ---------- –ì–õ–û–ë–ê–õ–¨–ù–Ü –ó–ú–Ü–ù–ù–Ü ---------- */
    let results = {};
    const events = ["–û–±—Ä—É—á", "–ú'—è—á", "–ë—É–ª–∞–≤–∏", "–°—Ç—Ä—ñ—á–∫–∞"];

    function renderTable() {
      const tbody = document.getElementById("results-body");
      tbody.innerHTML = "";

      const arr = Object.values(results).map(g => ({
        ...g,
        sum: events.reduce((s, e) => s + (parseFloat(g[e]) || 0), 0)
      })).sort((a,b)=>b.sum - a.sum);

      arr.forEach((g,i)=>{
        const tr = document.createElement("tr");
        const isLeader = i===0;
        tr.innerHTML = `
          <td>${i+1}</td>
          <td>${isLeader ? "üëë " : ""}${g.name}</td>
          <td>${g.club}</td>
          ${events.map(e=>`<td>${g[e]||""}</td>`).join("")}
          <td>${g.sum ? g.sum.toFixed(3):""}</td>
        `;
        tbody.appendChild(tr);
      });
    }

    function saveGymnast(name, club, event, score) {
      if(!name || !event || !score) return;
      const key = name.trim().toLowerCase().replace(/\s+/g,"_");
      const dataRef = ref(db, "gymnasts/" + key);

      get(dataRef).then(snap=>{
        const old = snap.exists()? snap.val() : {};
        old.name = name;
        old.club = club || old.club || "";
        old[event] = parseFloat(score);
        update(dataRef, old);
      });
    }

    /* ---------- –†–ï–ê–õ–¨–ù–ï –û–ù–û–í–õ–ï–ù–ù–Ø ---------- */
    onValue(ref(db,"gymnasts"), snap=>{
      results = snap.val() || {};
      renderTable();
    });

    /* ---------- –î–û–î–ê–í–ê–ù–ù–Ø –£–ß–ê–°–ù–ò–¶–Ü ---------- */
    window.addGymnast = function() {
      const n=document.getElementById("name").value.trim();
      const c=document.getElementById("club").value.trim();
      const e=document.getElementById("event").value;
      const s=document.getElementById("score").value.trim();
      saveGymnast(n,c,e,s);
      document.getElementById("score").value="";
    };

    window.clearTable = function(){
      document.getElementById("results-body").innerHTML="";
    };

    /* ---------- –í–•–Ü–î –°–£–î–î–Ü ---------- */
    window.checkPassword = function(){
      const p = prompt("–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å —Å—É–¥–¥—ñ:");
      if(p==="123"){
        document.getElementById("judge-panel").style.display="block";
      } else {
        alert("‚ùå –ù–µ–≤—ñ—Ä–Ω–∏–π –ø–∞—Ä–æ–ª—å");
      }
    };
  </script>

  <style>
    body{
      margin:0;
      font-family:Arial, sans-serif;
      background:#0d0d0d;
      color:#f6c453;
      overflow-x:hidden;
    }
    h1{
      text-align:center;
      color:#f6c453;
      text-shadow:0 0 20px #f6c453;
    }
    table{
      width:100%;
      border-collapse:collapse;
      background:rgba(30,30,30,.9);
      border-radius:14px;
      box-shadow:0 0 20px rgba(246,196,83,.3);
    }
    th,td{
      padding:6px;
      text-align:center;
      color:#f6c453;
    }
    th{
      border-bottom:2px solid #f6c453;
    }
    #judge-panel{
      display:none;
      padding:1rem;
      background:#1e1e1e;
      position:fixed;
      bottom:0;
      width:100%;
      box-shadow:0 -2px 10px rgba(246,196,83,.3);
    }
    input,select{
      background:#000;
      color:#f6c453;
      border:1px solid #f6c453;
      border-radius:5px;
      padding:4px 6px;
      margin:3px;
    }
    button{
      background:linear-gradient(90deg,#f6c453,#b8860b);
      border:none;
      border-radius:8px;
      color:#000;
      font-weight:bold;
      padding:5px 10px;
      cursor:pointer;
    }
    .leaf{
      position:fixed;
      top:-10vh;
      color:#ffd700;
      font-size:24px;
      opacity:.8;
      animation:fall linear infinite;
      z-index:-1;
    }
    @keyframes fall{
      0%{transform:translateY(0) rotate(0);}
      100%{transform:translateY(110vh) rotate(360deg);}
    }
  </style>
</head>

<body>
  <h1>–ó–æ–ª–æ—Ç–∞ –û—Å—ñ–Ω—å 2025 üçÅ</h1>
  <table>
    <thead>
      <tr>
        <th>–ú—ñ—Å—Ü–µ</th><th>–Ü–º‚Äô—è</th><th>–ö–ª—É–±</th>
        <th>–û–±—Ä—É—á</th><th>–ú'—è—á</th><th>–ë—É–ª–∞–≤–∏</th><th>–°—Ç—Ä—ñ—á–∫–∞</th><th>–°—É–º–∞</th>
      </tr>
    </thead>
    <tbody id="results-body"></tbody>
  </table>

  <div id="judge-panel">
    <input id="name" placeholder="–ü—Ä—ñ–∑–≤–∏—â–µ —Ç–∞ —ñ–º‚Äô—è" />
    <input id="club" placeholder="–ö–æ–º–∞–Ω–¥–∞" />
    <select id="event">
      <option>–û–±—Ä—É—á</option>
      <option>–ú'—è—á</option>
      <option>–ë—É–ª–∞–≤–∏</option>
      <option>–°—Ç—Ä—ñ—á–∫–∞</option>
    </select>
    <input id="score" placeholder="–û—Ü—ñ–Ω–∫–∞" />
    <button onclick="addGymnast()">‚ûï –î–æ–¥–∞—Ç–∏</button>
    <button onclick="clearTable()">üßπ –û—á–∏—Å—Ç–∏—Ç–∏ —Ç–∞–±–ª–∏—Ü—é</button>
  </div>

  <button style="position:fixed;bottom:10px;right:10px;" onclick="checkPassword()">üîê –£–≤—ñ–π—Ç–∏ —è–∫ —Å—É–¥–¥—è</button>

  <script>
    /* –î–æ–¥–∞—î–º–æ –ª–∏—Å—Ç–æ—á–∫–∏ üçÅ */
    for(let i=0;i<25;i++){
      const l=document.createElement("div");
      l.className="leaf";
      l.textContent=Math.random()>0.5?"üçÅ":"üçÇ";
      l.style.left=Math.random()*100+"vw";
      l.style.animationDuration=15+Math.random()*15+"s";
      l.style.animationDelay=Math.random()*20+"s";
      document.body.appendChild(l);
    }
  </script>
</body>
</html>
