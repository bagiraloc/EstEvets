<!DOCTYPE html>
<html lang="uk">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>–ó–æ–ª–æ—Ç–∞ –û—Å—ñ–Ω—å 2025</title>

  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.12.2/firebase-database.js"></script>

  <style>
    body {
      background-color: #0d0d0d;
      color: #f6c453;
      font-family: 'Segoe UI', sans-serif;
      overflow-x: hidden;
      margin: 0;
      padding: 0;
    }
    h1 {
      text-align: center;
      color: #f6c453;
      text-shadow: 0 0 20px #f6c453;
      margin-top: 20px;
    }
    table {
      width: 90%;
      margin: 20px auto;
      border-collapse: collapse;
      background: rgba(30,30,30,0.9);
      border-radius: 14px;
      box-shadow: 0 0 20px rgba(246,196,83,0.3);
      font-size: 1rem;
    }
    th, td {
      padding: 8px;
      text-align: center;
      color: #f6c453;
      border-bottom: 1px solid #f6c453;
    }
    th {
      background-color: #1e1e1e;
    }
    .admin {
      position: fixed;
      bottom: 0;
      width: 100%;
      background: rgba(20,20,20,0.95);
      border-top: 2px solid #f6c453;
      padding: 10px;
      text-align: center;
      display: none;
    }
    input, select {
      padding: 6px;
      margin: 4px;
      border-radius: 6px;
      border: none;
      outline: none;
    }
    button {
      padding: 8px 16px;
      background: linear-gradient(90deg, #f6c453, #b8860b);
      border: none;
      border-radius: 8px;
      font-weight: bold;
    }
    button:hover {
      background: linear-gradient(90deg, #ffd700, #f6c453);
    }
    #login {
      text-align: center;
      margin-top: 40px;
    }
  </style>
</head>
<body>

<h1>–ó–æ–ª–æ—Ç–∞ –û—Å—ñ–Ω—å 2025 üçÅ</h1>
<div id="table-container"></div>

<div id="login">
  <h3>üîê –í—Ö—ñ–¥ –¥–ª—è —Å—É–¥–¥—ñ</h3>
  <input type="password" id="password" placeholder="–í–≤–µ–¥—ñ—Ç—å –ø–∞—Ä–æ–ª—å">
  <button onclick="checkPassword()">–£–≤—ñ–π—Ç–∏</button>
</div>

<div class="admin" id="adminPanel">
  <select id="event">
    <option value="–æ–±—Ä—É—á">–û–±—Ä—É—á</option>
    <option value="–º'—è—á">–ú'—è—á</option>
    <option value="–±—É–ª–∞–≤–∏">–ë—É–ª–∞–≤–∏</option>
    <option value="—Å—Ç—Ä—ñ—á–∫–∞">–°—Ç—Ä—ñ—á–∫–∞</option>
  </select>
  <input id="name" placeholder="–Ü–º'—è —Ç–∞ –ø—Ä—ñ–∑–≤–∏—â–µ">
  <input id="club" placeholder="–ö–ª—É–±">
  <input id="score" placeholder="–û—Ü—ñ–Ω–∫–∞ (–Ω–∞–ø—Ä. 27.350)">
  <button onclick="addGymnast()">–î–æ–¥–∞—Ç–∏</button>
</div>

<script>
  // üî• Firebase
  const firebaseConfig = {
    apiKey: "AIzaSyDBXt2gMo92d6MpzxdzEvLI8UMcyHipVTg",
    authDomain: "estevents.firebaseapp.com",
    databaseURL: "https://estevents-default-rtdb.europe-west1.firebasedatabase.app",
    projectId: "estevents",
    storageBucket: "estevents.firebasestorage.app",
    messagingSenderId: "227576344701",
    appId: "1:227576344701:web:adf679a530b4ce72d5c114",
    measurementId: "G-3ZDEP57KXF"
  };
  const app = firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  const password = "123";

  function checkPassword() {
    const input = document.getElementById("password").value;
    if (input === password) {
      document.getElementById("login").style.display = "none";
      document.getElementById("adminPanel").style.display = "block";
    } else {
      alert("‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–∏–π –ø–∞—Ä–æ–ª—å");
    }
  }

  function addGymnast() {
    const name = document.getElementById("name").value.trim();
    const club = document.getElementById("club").value.trim();
    const event = document.getElementById("event").value;
    const score = parseFloat(document.getElementById("score").value.replace(",", "."));
    if (!name || !club || isNaN(score)) {
      alert("‚ö†Ô∏è –ó–∞–ø–æ–≤–Ω—ñ—Ç—å —É—Å—ñ –ø–æ–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ!");
      return;
    }

    const ref = db.ref("gymnasts/" + name.replaceAll(".", "_"));
    ref.once("value").then(snapshot => {
      let data = snapshot.val() || { club: club, events: {} };
      data.events[event] = score;

      // –ü—ñ–¥—Ä–∞—Ö—É–Ω–æ–∫ —Å—É–º–∏
      let sum = 0;
      for (let key in data.events) sum += data.events[key];
      data.sum = sum;

      ref.set(data);
      document.getElementById("score").value = "";
    });
  }

  // –í–∏–≤—ñ–¥ —Ç–∞–±–ª–∏—Ü—ñ
  const container = document.getElementById("table-container");
  db.ref("gymnasts").on("value", snapshot => {
    const data = snapshot.val() || {};
    const arr = Object.entries(data).map(([name, val]) => ({
      name, club: val.club, ...val.events, sum: val.sum || 0
    }));

    arr.sort((a, b) => b.sum - a.sum);

    let html = "<table><thead><tr><th>–ú—ñ—Å—Ü–µ</th><th>–Ü–º‚Äô—è</th><th>–ö–ª—É–±</th><th>–û–±—Ä—É—á</th><th>–ú‚Äô—è—á</th><th>–ë—É–ª–∞–≤–∏</th><th>–°—Ç—Ä—ñ—á–∫–∞</th><th>–°—É–º–∞</th></tr></thead><tbody>";
    arr.forEach((x, i) => {
      html += `<tr><td>${i + 1}</td><td>${x.name}</td><td>${x.club}</td>
      <td>${x["–æ–±—Ä—É—á"] ?? ""}</td><td>${x["–º'—è—á"] ?? ""}</td><td>${x["–±—É–ª–∞–≤–∏"] ?? ""}</td><td>${x["—Å—Ç—Ä—ñ—á–∫–∞"] ?? ""}</td><td>${(x.sum || 0).toFixed(3)}</td></tr>`;
    });
    html += "</tbody></table>";
    container.innerHTML = html;
  });
</script>

</body>
</html>
